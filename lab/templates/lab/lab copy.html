{% extends "base.html" %}



{% block content %}


<div class="lab-container">
  <div class="tabs">
    <button class="tab active" data-lang="html">HTML</button>
    <button class="tab" data-lang="css">CSS</button>
    <button class="tab" data-lang="js">JS</button>
  </div>

  <div class="editors">
    <textarea id="html-editor"></textarea>
    <textarea id="css-editor"></textarea>
    <textarea id="js-editor"></textarea>
  </div>

  <button id="run-btn">Run</button>
  <iframe id="preview"></iframe>
</div>

<!-- CodeMirror CSS & JS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/htmlmixed/htmlmixed.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/css/css.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/javascript/javascript.min.js"></script>

<style>
body {
  background: #1e1e1e;
  color: #c5c8c6;
  font-family: 'Courier New', monospace;
  margin: 0;
  padding: 0;
}
.lab-container {
  display: flex;
  flex-direction: column;
  gap: 10px;
  max-width: 900px;
  margin: 20px auto;
}
.tabs button {
  background: #1e1e1e;
  border: 1px solid #555;
  color: #c5c8c6;
  padding: 5px 10px;
  cursor: pointer;
}
.tabs button.active {
  background: #333;
}
.editors .CodeMirror {
  height: 200px;
  display: none; /* Hide all by default */
}
#preview {
  height: 300px;
  width: 100%;
  border: 1px solid #555;
  background: #ccc; /* Gray background */
}
#run-btn {
  padding: 5px 10px;
  background: #333;
  color: #c5c8c6;
  border: 1px solid #555;
  cursor: pointer;
}
</style>

<script>
const editors = {
  html: CodeMirror.fromTextArea(document.getElementById("html-editor"), { mode: "htmlmixed", theme: "default", lineNumbers: true }),
  css: CodeMirror.fromTextArea(document.getElementById("css-editor"), { mode: "css", theme: "default", lineNumbers: true }),
  js: CodeMirror.fromTextArea(document.getElementById("js-editor"), { mode: "javascript", theme: "default", lineNumbers: true })
};

// Show only HTML initially
{% comment %} editors.html.getWrapperElement().style.display = "block"; {% endcomment %}

// Show only HTML initially
Object.keys(editors).forEach(lang => {
  if (lang === "html") {
    editors[lang].getWrapperElement().style.display = "block";
    editors[lang].refresh();
  } else {
    editors[lang].getWrapperElement().style.display = "none";
  }
});

// Tab switching
document.querySelectorAll(".tab").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
    btn.classList.add("active");
    const lang = btn.dataset.lang;
    Object.keys(editors).forEach(l => {
      if (l === lang) {
        editors[l].getWrapperElement().style.display = "block";
        editors[l].refresh(); // <--- important
      } else {
        editors[l].getWrapperElement().style.display = "none";
      }
    });
  });
});


// Run button
document.getElementById("run-btn").addEventListener("click", () => {
  const htmlCode = editors.html.getValue();
  const cssCode = editors.css.getValue();
  const jsCode = editors.js.getValue();

  const preview = document.getElementById("preview");
  const previewDoc = preview.contentDocument || preview.contentWindow.document;

  previewDoc.open();
  previewDoc.write('<!DOCTYPE html><html><head><style>' + cssCode + '</style></head><body>' + htmlCode + '<script>' + jsCode + '<\/script></body></html>');
  previewDoc.close();
});
</script>





{% comment %} <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Lab</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css" />

<style>
body {
  background: #1e1e1e;
  color: #c5c8c6;
  font-family: 'Courier New', monospace;
  margin: 0;
  padding: 0;
}
.lab-container {
  display: flex;
  flex-direction: column;
  gap: 10px;
  max-width: 900px;
  margin: 20px auto;
}
.tabs button {
  background: #1e1e1e;
  border: 1px solid #555;
  color: #c5c8c6;
  padding: 5px 10px;
  cursor: pointer;
}
.tabs button.active {
  background: #333;
}
.editors .CodeMirror {
  height: 200px;
}
#preview {
  height: 300px;
  width: 100%;
  border: 1px solid #555;
  background: black;
}
#run-btn {
  padding: 5px 10px;
  background: #333;
  color: #c5c8c6;
  border: 1px solid #555;
  cursor: pointer;
}
</style>
</head>
<body>
<div class="lab-container">
  <div class="tabs">
    <button class="tab active" data-lang="html">HTML</button>
    <button class="tab" data-lang="css">CSS</button>
    <button class="tab" data-lang="js">JS</button>
  </div>

  <div class="editors">
    <textarea id="html-editor"></textarea>
    <textarea id="css-editor" style="display:none"></textarea>
    <textarea id="js-editor" style="display:none"></textarea>
  </div>

  <button id="run-btn">Run</button>
  <iframe id="preview"></iframe>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/htmlmixed/htmlmixed.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/css/css.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/javascript/javascript.min.js"></script>

<script>
const editors = {
  html: CodeMirror.fromTextArea(document.getElementById("html-editor"), {
    mode: "htmlmixed",
    theme: "default",
    lineNumbers: true
  }),
  css: CodeMirror.fromTextArea(document.getElementById("css-editor"), {
    mode: "css",
    theme: "default",
    lineNumbers: true
  }),
  js: CodeMirror.fromTextArea(document.getElementById("js-editor"), {
    mode: "javascript",
    theme: "default",
    lineNumbers: true
  })
};

// Tab switching
document.querySelectorAll(".tab").forEach(btn => {
  btn.addEventListener("click", () => {
    document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
    btn.classList.add("active");
    const lang = btn.dataset.lang;
    Object.keys(editors).forEach(l => {
      editors[l].getWrapperElement().style.display = (l === lang ? "block" : "none");
    });
  });
});

// Run button
document.getElementById("run-btn").addEventListener("click", () => {
  const htmlCode = editors.html.getValue();
  const cssCode = editors.css.getValue();
  const jsCode = editors.js.getValue();

  const preview = document.getElementById("preview");
  const previewDoc = preview.contentDocument || preview.contentWindow.document;

  // Write iframe content safely
  previewDoc.open();
  previewDoc.write('<!DOCTYPE html><html><head><style>' + cssCode + '</style></head><body>' + htmlCode + '<script>' + jsCode + '<\/script></body></html>');
  previewDoc.close();
});
</script>
</body>
</html> {% endcomment %}

{% endblock content %}